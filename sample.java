first 100 lines of code
modified by master
